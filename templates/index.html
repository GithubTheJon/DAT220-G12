<!DOCTYPE html>
<html>
<head>
    <title>Social Media Posts</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f9f9f9; margin: 20px; }
        .post-container { width: 70%; margin: 0 auto; }
        .post { background: white; padding: 15px; margin-bottom: 10px; border-radius: 8px; box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1); }
        .username { font-weight: bold; color: #333; }
        .content { margin: 10px 0; }
        .option_div {display: flex; justify-content: space-between; align-items: center;}
        .likes { color: red; font-size: 14px; border-radius: 5px; cursor: pointer; background-color: inherit; margin: 0}
        .likes:hover { background-color: rgb(255, 235, 238); box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1)}
        .comments {color: gray; align-items: center; cursor: pointer}
        .comments:hover { background-color: #faffff; border-radius: 5px; color: black; box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1)}
        a {text-decoration: none; color: inherit;}
        .comment-container { width: 60%; margin: 0 auto; box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1); background-color: #faffff; border-radius: 20px;}
    </style>
</head>
<body>
    <h2 style="text-align: center;">Recent Posts</h2>

    
    <div class="post-container">
        <div class="post">
            <h3 style="align-content: center"> Create New Post</h3>
        </div>
    </div>

    <div class="post-container">
        {% for post in posts %}
            {% set post_id = post[0] %}
            {% set username = post[1] %}
            {% set content = post[2] %}
            {% set likes = post[3] %}
    
            <div class="post">
                <div class="username">
                    <a href="{{ url_for('user_page', username=username) }}">{{ username }}</a>
                </div>
    
                <div class="content">{{ content }}</div>
    
                <div class="option_div">
                    {% if user_id %}
                        {% if post_id in liked_post_ids %}
                            <!-- ‚ù§Ô∏è Unlike form -->
                            <form method="POST" action="{{ url_for('unlike_post', post_id=post_id) }}" class="likes">
                                <button type="submit" class="likes" style="border: none; background: none; cursor: pointer;">
                                    ‚ù§Ô∏è {{ likes }} Likes
                                </button>
                            </form>
                        {% else %}
                            <!-- ü§ç Like form -->
                            <form method="POST" action="{{ url_for('like_post', post_id=post_id) }}" class="likes">
                                <button type="submit" class="likes" style="border: none; background: none; cursor: pointer;">
                                    ü§ç {{ likes }} Likes
                                </button>
                            </form>
                        {% endif %}
                    {% else %}
                        <div class="likes" style="color: gray;">‚ù§Ô∏è {{ likes }} Likes</div>
                    {% endif %}
                
                    <div class="comments" onclick="toggleComments('comments-{{ post_id }}')">show comments</div>
                </div>
                
                
    
                <div id="comments-{{ post_id }}" class="comment-container" style="display: none; padding: 10px;">
                    {% for comment in comments_by_post.get(post_id, []) %}
                        <p><strong>{{ comment.username }}:</strong> {{ comment.content }}</p>
                    {% else %}
                        <p style="color: black;">No comments yet.</p>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}
    </div>

    <script>
        function toggleComments(id) {
            const show_comments = document.getElementById(id);
            show_comments.style.display = (show_comments.style.display === "none" || show_comments.style.display === "") ? "block" : "none";
        }
    </script>
    

</body>
</html>
